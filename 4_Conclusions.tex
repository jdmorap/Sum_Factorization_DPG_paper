\section{Conclusions}

A complete set of algorithms for fast integration of Gram matrices for $H^1$, $H(\curl)$, $H(\div)$ and $L^2$ spaces for a general parametric hexahedral element has been presented. The algorithms are based on the sum factorization of tensor-product shape functions. Critical for efficiency is the use of hierarchical shape functions - Legendre polynomials and their integrals - for the exact 1D sequence. The expected reduction of computational complexity from $\mcO(p^9)$ to $\mcO(p^7)$ was verified numerically for the $H^1$, $H(\div)$ and $H(\curl)$ cases. Of special significance was the implementation of a problem with the ultraweak variational formulation, that allowed the full application of the tensor-product-based integration to both the stiffness matrix and load vector, unlike the other problems studied, for which only the Gram matrix could be treated under this scheme.

Although in some cases, the time saving in obtaining the Gram matrix is as dramatic as going from 22 seconds to half second (acoustics, $p_r=8$), and this result should persuade some users to consider the implementation of this set of algorithms, some extra work on this idea seems relevant in order to consolidate the concept of fast integration in DPG thanks to a tensor-product-based integration. Such future work may include a specific way of dealing with the stiffness and load arrays when the trial shape functions require compatibility between adjacent elements; extending these ideas to the computation of the interfacial contributions to the stiffness matrix and load vector; the application of these algorithms to more boundary-value problems that have been studied with DPG, so that more test spaces can be tried with this approach, as well as more non conventional norms get to be implemented under this perspective; and finally, propose the algorithms for other types of 2D and 3D elements.

\paragraph{Acknowledgments.}
Jaime Mora has been sponsored by a 2015 Colciencias-Fulbright scholarship, granted by the Government of Colombia and the Fulbright Commission-Colombia. Leszek Demkowicz has been supported by a grant from AFOSR (FA9550-12-1-0484).